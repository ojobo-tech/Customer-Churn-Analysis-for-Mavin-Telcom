# Mavin-Telcom

SELECT *
FROM telecom_customer_churn;

ALTER TABLE telecom_customer_churn RENAME COLUMN `Customer ID` TO Customer_ID;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Zip Code` TO zip_code;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Number of Dependents` TO no_of_dependents;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Number of Referrals` TO no_of_referrals;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Tenure in Months` TO tenure_in_months;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Phone Service` TO phone_service;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Avg Monthly Long Distance Charges` TO avg_monthly_long_distance_charges;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Multiple Lines` TO multiple_lines;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Internet Service` TO internet_service;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Internet Type` TO internet_type;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Avg Monthly GB Download` TO avg_monthly_gb_download;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Online Security` TO online_security;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Online Backup` TO online_backup;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Device Protection Plan` TO device_protection_plan;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Premium Tech Support` TO premium_tech_support;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Streaming TV` TO streaming_tv;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Streaming Movies` TO streaming_movies;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Streaming Music` TO streaming_music;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Unlimited Data` TO unlimited_data;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Contract` TO contract;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Paperless Billing` TO paperless_billing;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Payment Method` TO payment_method;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Monthly Charge` TO monthly_charge;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Total Charges` TO total_charges;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Total Revenue` TO total_revenue;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Total Refunds` TO total_refunds;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Total Extra Data Charges` TO total_extra_data_charges;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Customer Status` TO customer_status;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Total Long Distance Charges` TO total_long_distance_charges;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Churn Category` TO churn_category;
ALTER TABLE telecom_customer_churn RENAME COLUMN `Churn Reason` TO churn_reason;

# Checking for duplicate data
SELECT Customer_ID, COUNT(Customer_ID) as count
FROM telecom_customer_churn
GROUP BY Customer_ID
HAVING count(Customer_ID) > 1;

# How many customerrs did Maven Telecom have in this period?
SELECT COUNT(Customer_ID) as total_customers
FROM telecom_customer_churn;

# How many customerrs did Maven Telecom have in this period based on Customer Status?
SELECT customer_status, COUNT(Customer_ID) as total_customers
FROM telecom_customer_churn
GROUP BY customer_status;

# Percentage of Maven customers lost to churn
SELECT customer_status, COUNT(Customer_ID) as total_customers,
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
GROUP BY customer_status;

# How much revenue did Maven get in this period?--
SELECT ROUND(SUM(total_revenue),0) as revenue
FROM telecom_customer_churn;

# How much revenue did Maven lose to churning?
SELECT customer_status, ROUND(SUM(total_revenue),0) as revenue
FROM telecom_customer_churn
GROUP BY customer_status;

# How much revenue percentage revenue did Maven lose to churned customers?
SELECT Customer_Status, ROUND(SUM(total_revenue),0) as revenue, 
ROUND((SUM(total_revenue) * 100.0) / SUM(SUM(total_revenue)) OVER(), 1) AS Revenue_Percentage 
FROM telecom_customer_churn
GROUP BY Customer_Status;

# Gender of churned customers--
SELECT gender, COUNT(Customer_ID) as count,
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY gender;

# Revenue generated by Maven based on Customer Gender
SELECT gender, ROUND(SUM(total_revenue),0) as revenue, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
GROUP BY gender;

# Revenue lost by Maven based on Gender of churned customers--
SELECT gender, ROUND(SUM(total_revenue),0) as revenue, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY gender;


# Marital Status of churned customers--
SELECT married as marital_status, COUNT(Customer_ID) as count,
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY marital_status;

# Revenue lost by Maven based on Marital Status of churned customers---
SELECT married, ROUND(SUM(total_revenue),0) as revenue, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY married;


# Tenure for for which churned customers stayed with Maven
SELECT
    CASE 
        WHEN tenure_in_months <= 6 THEN '6 months'
        WHEN tenure_in_months <= 12 THEN '1 Year'
        WHEN tenure_in_months <= 24 THEN '2 Years'
        ELSE '> 2 Years'
    END AS Tenure,
    ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE Customer_Status = 'Churned'
GROUP BY
    CASE 
        WHEN Tenure_in_Months <= 6 THEN '6 months'
        WHEN Tenure_in_Months <= 12 THEN '1 Year'
        WHEN Tenure_in_Months <= 24 THEN '2 Years'
        ELSE '> 2 Years'
    END
ORDER BY Churn_Percentage DESC;

# Age category of churned customers
SELECT 
    CASE 
        WHEN age <= 25 THEN 'Gen Z (<25)'
        WHEN age <= 40 THEN 'Millenial (25-40)'
        WHEN age <= 55 THEN 'Baby Boomer (40-55)'
		WHEN age <= 65 THEN 'Senior Citizen (55-65)'
        ELSE 'Retired (>65)'
    END AS Age_category,
    ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE Customer_Status = 'Churned'
GROUP BY
    CASE 
        WHEN age <= 25 THEN 'Gen Z (<25)'
        WHEN age <= 40 THEN 'Millenial (25-40)'
        WHEN age <= 55 THEN 'Baby Boomer (40-55)'
		WHEN age <= 65 THEN 'Senior Citizen (55-65)'
        ELSE 'Retired (>65)'
    END
ORDER BY Churn_Percentage DESC;

#Payment method used by Churned customers
SELECT payment_method, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY payment_method
ORDER BY Churn_Percentage DESC;

# What Category produced the highest churn?
SELECT churn_category, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY churn_category
ORDER BY Churn_Percentage DESC;

# Reason for Churn 
SELECT churn_reason, churn_category, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY churn_reason, churn_category
ORDER BY Churn_Percentage DESC;

# Reason for Churn lost to competitors
SELECT churn_reason, 
ROUND((SUM(total_revenue) * 100.0) / SUM(SUM(total_revenue)) OVER(), 1) AS Revenue_Percentage , 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned' and churn_category = 'Competitor'
GROUP BY churn_reason, churn_category
ORDER BY Churn_Percentage DESC;

# Internet Type used by Churned customers
SELECT internet_type, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY internet_type
ORDER BY Churn_Percentage DESC;

# What Contract type did the Churned Customers Have?
SELECT contract, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY contract
ORDER BY Churn_Percentage DESC;

# What Type of offer did the Churned Customers receive from Maven Telecom?
SELECT offer, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY offer
ORDER BY Churn_Percentage DESC;

# Did the Churned Customers received Premium Tech Support?
SELECT premium_tech_support, 
ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY premium_tech_support
ORDER BY Churn_Percentage DESC;


# From which city did Maven experience the most churn?
SELECT City, COUNT(Customer_ID) AS Churned, 
Round(COUNT(Customer_ID)*100/SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY City
ORDER BY Churned DESC
LIMIT 3;


# How many dependents do our Churned Customers have?
SELECT no_of_dependents, ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY no_of_dependents
ORDER BY Churn_Percentage DESC;

# How many referrals did our Churned Customers make?
SELECT no_of_referrals, ROUND(COUNT(Customer_ID) * 100.0 / SUM(COUNT(Customer_ID)) OVER(),1) AS Churn_Percentage
FROM telecom_customer_churn
WHERE customer_status = 'Churned'
GROUP BY no_of_referrals
ORDER BY Churn_Percentage DESC;
